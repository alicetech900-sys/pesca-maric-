<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secretaria de Pesca - Protótipo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5;
        }
        .app-container {
            max-width: 400px;
            height: 800px;
            margin: 2rem auto;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            border-radius: 20px;
            background-color: #fff;
            position: relative;
            display: flex;
            flex-direction: column;
        }
        .main-content {
            padding: 1rem;
            flex: 1;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            padding-bottom: 5rem; /* Espaço para o menu inferior */
        }
        .screen {
            display: none;
        }
        .screen.active {
            display: block;
        }
        .sidebar {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: -100%;
            background-color: #fff;
            box-shadow: 4px 0 10px rgba(0,0,0,0.1);
            transition: left 0.3s ease-in-out;
            z-index: 50;
            display: flex;
            flex-direction: column;
        }
        .sidebar.active {
            left: 0;
        }
        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 40;
        }
        .overlay.active {
            display: block;
        }
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 400px;
            background-color: #fff;
            border-top: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-around;
            padding: 0.5rem 0;
            box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.05);
            z-index: 50;
        }
        .nav-button {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 0.5rem;
            border-radius: 9999px; /* rounded-full */
            color: #6b7280; /* text-gray-500 */
            transition: all 0.2s ease-in-out;
            cursor: pointer;
            text-decoration: none;
        }
        .nav-button .icon {
            font-size: 1.25rem; /* text-xl */
            margin-bottom: 0.25rem;
        }
        .nav-button .label {
            font-size: 0.75rem; /* text-xs */
            line-height: 1rem;
        }
        .nav-button.active {
            color: #1d4ed8; /* text-blue-700 */
        }
        .loading-indicator {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            padding: 2rem;
            color: #4a5568;
        }
        .instagram-post {
            background-color: #fff;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            padding: 1rem;
        }
        .instagram-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }
        .news-card {
            display: flex;
            gap: 1rem;
            background-color: #fff;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            padding: 1rem;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .news-card:hover {
            transform: translateY(-2px);
        }
        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            height: 100%;
            background-color: #f7fafc;
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: inset 0 0 5px rgba(0,0,0,0.05);
        }
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        .chat-input-container {
            display: flex;
            padding: 1rem;
            border-top: 1px solid #e2e8f0;
            background-color: #fff;
        }
        .chat-input {
            flex: 1;
            border-radius: 9999px;
            padding: 0.5rem 1rem;
            border: 1px solid #cbd5e0;
        }
        .chat-send-btn {
            background-color: #3b82f6;
            color: white;
            border-radius: 9999px;
            padding: 0.5rem 1rem;
            margin-left: 0.5rem;
            font-weight: bold;
        }
        .message {
            max-width: 80%;
            padding: 0.75rem;
            border-radius: 1rem;
        }
        .user-message {
            align-self: flex-end;
            background-color: #e2e8f0;
            color: #1a202c;
        }
        .ia-message {
            align-self: flex-start;
            background-color: #3b82f6;
            color: #fff;
        }
        .ia-loading-message {
            align-self: flex-start;
            color: #6b7280;
            font-style: italic;
        }
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            visibility: hidden;
            opacity: 0;
            transition: visibility 0s, opacity 0.3s;
        }
        .modal.active {
            visibility: visible;
            opacity: 1;
        }
        .modal-content {
            background-color: #fff;
            padding: 1.5rem;
            border-radius: 1rem;
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
            position: relative;
        }
        .aspect-ratio-4-5 {
            position: relative;
            width: 100%;
            padding-top: 125%; /* 5 / 4 = 1.25 */
        }
        .aspect-ratio-4-5 img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        .sub-category-card {
            display: flex;
            align-items: center;
            gap: 1rem;
            background-color: #fff;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            padding: 1rem;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .sub-category-card:hover {
            transform: translateY(-2px);
        }
        .sub-category-icon-bg {
            background-color: #e2e8f0;
            border-radius: 50%;
            padding: 0.75rem;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal-fish-img-container {
            position: relative;
            width: 100%;
            padding-top: 56.25%; /* 16:9 Aspect Ratio */
            max-width: 300px;
            margin: 0 auto 1rem auto;
            overflow: hidden;
            border-radius: 0.5rem;
        }
        .modal-fish-img-container img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .ia-feature-card {
            display: flex;
            align-items: center;
            gap: 1rem;
            background-color: #fff;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            padding: 1rem;
            cursor: pointer;
            transition: transform 0.2s;
            border-left: 4px solid #3b82f6;
        }
        .ia-feature-card:hover {
            transform: translateY(-2px);
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">

<div class="app-container">
    
    <!-- Overlay para fechar o menu lateral e modais -->
    <div id="overlay" class="overlay"></div>

    <!-- Menu Lateral (Sidebar) -->
    <div id="sidebar" class="sidebar p-4">
        <!-- Cabeçalho do menu lateral com a logo -->
        <div class="p-4 mb-8 text-center flex flex-col items-center gap-4">
            <img src="https://i.pinimg.com/736x/54/07/e2/5407e20320857e626a0c0b104529f87c.jpg" alt="Logo da Secretaria de Pesca de Maricá" class="w-24 h-24 object-cover rounded-full border-2 border-gray-200">
            <h2 class="text-xl font-bold">Secretaria de Pesca de Maricá</h2>
        </div>

        <!-- Botão para fechar o menu -->
        <button id="close-sidebar-btn" class="absolute top-4 right-4 text-gray-700 text-xl p-2 rounded-full hover:bg-gray-200 transition-colors">
            <i class="fa-solid fa-times"></i>
        </button>

        <!-- Itens de navegação do menu lateral -->
        <nav class="flex flex-col gap-2 flex-grow">
            <button class="nav-item flex items-center gap-4 p-4 rounded-xl font-medium text-lg hover:bg-gray-100 transition-colors" data-target="home">
                <i class="fa-solid fa-house w-6 text-center"></i>
                <span>Início</span>
            </button>
            <button class="nav-item flex items-center gap-4 p-4 rounded-xl font-medium text-lg hover:bg-gray-100 transition-colors" data-target="tide-table">
                <i class="fa-solid fa-water w-6 text-center"></i>
                <span>Tábua de Maré</span>
            </button>
            <button class="nav-item flex items-center gap-4 p-4 rounded-xl font-medium text-lg hover:bg-gray-100 transition-colors" data-target="events">
                <i class="fa-solid fa-calendar-alt w-6 text-center"></i>
                <span>Eventos e Competições</span>
            </button>
            <button class="nav-item flex items-center gap-4 p-4 rounded-xl font-medium text-lg hover:bg-gray-100 transition-colors" data-target="fishing-news">
                <i class="fa-solid fa-newspaper w-6 text-center"></i>
                <span>Notícias da Pesca</span>
            </button>
            <button class="nav-item flex items-center gap-4 p-4 rounded-xl font-medium text-lg hover:bg-gray-100 transition-colors" data-target="fishing-info">
                <i class="fa-solid fa-fish w-6 text-center"></i>
                <span>Informações da Pesca</span>
            </button>
            <button class="nav-item flex items-center gap-4 p-4 rounded-xl font-medium text-lg hover:bg-gray-100 transition-colors" data-target="ia-features">
                <i class="fa-solid fa-camera-retro w-6 text-center"></i>
                <span>Identificador de Peixe</span>
            </button>
        </nav>
    </div>

    <!-- Conteúdo Principal do Aplicativo -->
    <main class="flex flex-col flex-1 relative">
        <!-- Cabeçalho fixo no topo -->
        <header class="p-4 flex items-center justify-between shadow-sm bg-white z-10 sticky top-0">
            <button id="open-sidebar-btn" class="text-blue-600 text-xl p-2 rounded-full hover:bg-gray-100 transition-colors">
                <i class="fa-solid fa-bars"></i>
            </button>
            <div class="flex items-center justify-center gap-2 absolute left-1/2 -translate-x-1/2">
                <img src="https://i.pinimg.com/736x/54/07/e2/5407e20320857e626a0c0b104529f87c.jpg" alt="Logo da Secretaria de Pesca de Maricá" class="h-10 w-10 object-cover rounded-full">
                <span class="text-base font-bold text-gray-800 tracking-wider">Secretaria de Pesca de Maricá</span>
            </div>
            <div class="w-8"></div> <!-- Espaçamento para centralizar o título -->
        </header>

        <!-- Container principal de conteúdo com scroll -->
        <div class="main-content">
            
            <!-- Tela: Início com publicações do Instagram -->
            <section id="home" class="screen">
                <h2 class="text-2xl font-bold uppercase text-center mb-4 text-gray-800">Início</h2>
                <h3 class="text-lg font-medium text-gray-600 mb-4">Últimas Publicações do Instagram</h3>
                <div id="instagram-feed" class="flex flex-col gap-4">
                    <div class="elfsight-app-319fa19a-dd36-4a5f-8cff-1dc6f3c6d518" data-elfsight-app-lazy></div>
                </div>
            </section>
            
            <!-- Tela: Tábua de Maré -->
            <section id="tide-table" class="screen">
                <h2 class="text-2xl font-bold uppercase text-center mb-4 text-gray-800">Tábua de Maré</h2>
                <!-- Conteúdo da tábua de maré será inserido aqui via JavaScript -->
                <div id="tide-content" class="flex flex-col gap-4">
                    <!-- Placeholder de carregamento -->
                    <div class="loading-indicator">
                        <i class="fa-solid fa-water fa-spin-pulse fa-2x"></i>
                        <p>Carregando tábua de maré...</p>
                    </div>
                </div>
            </section>

            <!-- Tela: Eventos e Competições -->
            <section id="events" class="screen active">
                <h2 class="text-2xl font-bold uppercase text-center mb-4 text-gray-800">Eventos e Competições</h2>
                <div id="events-list" class="flex flex-col gap-4">
                    <!-- Eventos serão renderizados aqui -->
                    <!-- Placeholder de carregamento -->
                    <div class="loading-indicator">
                        <i class="fa-solid fa-calendar-alt fa-spin-pulse fa-2x"></i>
                        <p>Carregando eventos...</p>
                    </div>
                </div>
            </section>
            
            <!-- Tela: Notícias da Pesca -->
            <section id="fishing-news" class="screen">
                <h2 class="text-2xl font-bold uppercase text-center mb-4 text-gray-800">Notícias da Pesca</h2>
                <div id="news-list" class="flex flex-col gap-4">
                    <!-- As notícias serão inseridas aqui via JavaScript -->
                    <div class="loading-indicator">
                        <i class="fa-solid fa-newspaper fa-spin-pulse fa-2x"></i>
                        <p>Carregando notícias...</p>
                    </div>
                </div>
            </section>

            <!-- Tela: Informações da Pesca -->
            <section id="fishing-info" class="screen">
                <h2 class="text-2xl font-bold uppercase text-center mb-4 text-gray-800">Informações da Pesca</h2>
                <div id="sub-categories-list" class="flex flex-col gap-4">
                    <!-- As sub-categorias serão renderizadas aqui via JavaScript -->
                    <div class="loading-indicator">
                        <i class="fa-solid fa-fish fa-spin-pulse fa-2x"></i>
                        <p>Carregando informações...</p>
                    </div>
                </div>
            </section>

             <!-- Tela: Peixes Comuns (Sub-categoria) -->
            <section id="common-fish" class="screen">
                <div class="flex items-center justify-start gap-4 mb-4">
                    <button id="back-to-fishing-info-btn" class="text-gray-700 text-xl p-2 rounded-full hover:bg-gray-200 transition-colors">
                        <i class="fa-solid fa-arrow-left"></i>
                    </button>
                    <h2 class="text-2xl font-bold uppercase text-gray-800">Peixes Comuns</h2>
                </div>
                <div id="fish-list" class="flex flex-col gap-4">
                    <!-- A lista de peixes será renderizada aqui via JavaScript -->
                </div>
            </section>
            
            <!-- Outras Sub-categorias de Pesca (Telas) -->
            <section id="fishing-closed-season" class="screen">
                <div class="flex items-center justify-start gap-4 mb-4">
                    <button class="back-to-fishing-info-btn text-gray-700 text-xl p-2 rounded-full hover:bg-gray-200 transition-colors">
                        <i class="fa-solid fa-arrow-left"></i>
                    </button>
                    <h2 class="text-2xl font-bold uppercase text-gray-800">Período de Defeso</h2>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md">
                    <p class="text-gray-700 mb-4">
                        Período de Defeso é a época em que a pesca de uma ou mais espécies é proibida para garantir sua reprodução e a manutenção dos estoques pesqueiros.
                    </p>
                    <h3 class="font-bold text-lg mb-2">Defeso em Maricá:</h3>
                    <p class="text-sm text-gray-600">
                        O período de defeso na região de Maricá, para algumas espécies como a Tainha, geralmente ocorre de **Maio a Julho**. É importante sempre consultar a legislação mais recente para evitar multas.
                    </p>
                </div>
            </section>

            <section id="min-sizes" class="screen">
                <div class="flex items-center justify-start gap-4 mb-4">
                    <button class="back-to-fishing-info-btn text-gray-700 text-xl p-2 rounded-full hover:bg-gray-200 transition-colors">
                        <i class="fa-solid fa-arrow-left"></i>
                    </button>
                    <h2 class="text-2xl font-bold uppercase text-gray-800">Tamanhos Mínimos para Captura</h2>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md">
                    <p class="text-gray-700 mb-4">
                        A captura de peixes com tamanho inferior ao mínimo permitido por lei é considerada pesca predatória. Abaixo estão as medidas de algumas espécies comuns na região.
                    </p>
                    <ul class="flex flex-col gap-2">
                        <li class="flex justify-between font-semibold text-gray-700 bg-gray-50 p-3 rounded-lg">
                            <span>Tainha</span>
                            <span>30 cm</span>
                        </li>
                        <li class="flex justify-between font-semibold text-gray-700 bg-gray-50 p-3 rounded-lg">
                            <span>Pampo</span>
                            <span>25 cm</span>
                        </li>
                        <li class="flex justify-between font-semibold text-gray-700 bg-gray-50 p-3 rounded-lg">
                            <span>Robalo</span>
                            <span>35 cm</span>
                        </li>
                        <li class="flex justify-between font-semibold text-gray-700 bg-gray-50 p-3 rounded-lg">
                            <span>Corvina</span>
                            <span>20 cm</span>
                        </li>
                    </ul>
                </div>
            </section>

            <section id="best-fishing-times" class="screen">
                <div class="flex items-center justify-start gap-4 mb-4">
                    <button class="back-to-fishing-info-btn text-gray-700 text-xl p-2 rounded-full hover:bg-gray-200 transition-colors">
                        <i class="fa-solid fa-arrow-left"></i>
                    </button>
                    <h2 class="text-2xl font-bold uppercase text-gray-800">Melhores Horários de Pesca</h2>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md">
                    <h3 class="font-bold text-lg mb-2">Orientações Gerais:</h3>
                    <p class="text-gray-700 mb-4">
                        A pesca é influenciada por fatores como a maré, a lua e o horário do dia.
                    </p>
                    <ul class="list-disc list-inside text-gray-700 text-sm">
                        <li>**Maré:** A mudança de maré (virada da maré) é um dos melhores momentos para pescar. A maré enchente também é favorável.</li>
                        <li>**Lua:** Luas cheia e nova (marés vivas) geralmente são mais produtivas.</li>
                        <li>**Horário:** O nascer e o pôr do sol são períodos de maior atividade para a maioria dos peixes.</li>
                    </ul>
                </div>
            </section>

            <section id="licensing" class="screen">
                <div class="flex items-center justify-start gap-4 mb-4">
                    <button class="back-to-fishing-info-btn text-gray-700 text-xl p-2 rounded-full hover:bg-gray-200 transition-colors">
                        <i class="fa-solid fa-arrow-left"></i>
                    </button>
                    <h2 class="text-2xl font-bold uppercase text-gray-800">Licenciamento e Documentos</h2>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md">
                    <p class="text-gray-700 mb-4">
                        A licença de pesca amadora é obrigatória para a pesca de linha e anzol, tanto em água doce quanto salgada.
                    </p>
                    <h3 class="font-bold text-lg mb-2">Como tirar:</h3>
                    <ul class="list-disc list-inside text-gray-700 text-sm mb-4">
                        <li>Acesse o portal do Ministério da Pesca e Aquicultura.</li>
                        <li>Preencha o formulário com seus dados pessoais.</li>
                        <li>Pague a taxa de emissão da licença.</li>
                    </ul>
                    <a href="#" class="text-blue-600 font-semibold hover:underline">Link para o site oficial (simulado)</a>
                </div>
            </section>

             <!-- Tela de Identificação de Peixe -->
            <section id="ia-features" class="screen">
                <div class="flex items-center justify-start gap-4 mb-4">
                    <button id="back-to-home-btn" class="text-gray-700 text-xl p-2 rounded-full hover:bg-gray-200 transition-colors">
                        <i class="fa-solid fa-arrow-left"></i>
                    </button>
                    <h2 class="text-2xl font-bold uppercase text-gray-800">Identificador de Peixe</h2>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md flex flex-col items-center gap-4">
                    <input type="file" id="fish-image-input" accept="image/*" class="w-full">
                    <img id="fish-preview" src="https://placehold.co/300x200/e2e8f0/fff?text=Pré-visualização" class="w-full h-auto rounded-lg mb-4">
                    <button id="identify-fish-btn" class="bg-blue-600 text-white font-bold py-2 px-4 rounded-full hover:bg-blue-700 transition-colors">
                        Identificar Peixe
                    </button>
                    <div id="fish-result" class="text-gray-700 p-3 bg-gray-100 rounded-lg w-full">
                        Resultados da identificação aparecerão aqui...
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Modal para detalhes do evento -->
    <div id="event-modal" class="modal">
        <div class="modal-content">
            <button id="close-modal-btn" class="absolute top-4 right-4 text-gray-700 text-2xl p-2 rounded-full hover:bg-gray-200 transition-colors">
                <i class="fa-solid fa-times"></i>
            </button>
            <div class="aspect-ratio-4-5 rounded-lg mb-4">
                <img id="modal-event-img" src="" alt="Imagem do Evento" class="object-cover rounded-lg">
            </div>
            <h3 id="modal-event-title" class="font-bold text-2xl mb-2"></h3>
            <p id="modal-event-date" class="text-sm text-gray-500"></p>
            <p id="modal-event-time" class="text-sm text-gray-500"></p>
            <p id="modal-event-location" class="text-sm text-gray-500 mb-4"></p>
            <p id="modal-event-description" class="text-gray-700 text-base"></p>
        </div>
    </div>

    <!-- Modal para detalhes do peixe -->
    <div id="fish-modal" class="modal">
        <div class="modal-content">
            <button id="close-fish-modal-btn" class="absolute top-4 right-4 text-gray-700 text-2xl p-2 rounded-full hover:bg-gray-200 transition-colors">
                <i class="fa-solid fa-times"></i>
            </button>
            <div class="flex flex-col items-center">
                <div class="relative w-full mb-4 rounded-lg overflow-hidden" style="padding-top: 56.25%;"> <!-- 16:9 Aspect Ratio -->
                  <img id="modal-fish-img" src="" alt="Imagem do Peixe" class="absolute top-0 left-0 w-full h-full object-cover">
                </div>
                <h3 id="modal-fish-name" class="font-bold text-2xl mb-2"></h3>
                <p id="modal-fish-bio" class="text-gray-700 text-base text-center"></p>
            </div>
            <h4 class="font-bold text-lg mt-4">Dicas de Pesca</h4>
            <ul class="list-disc list-inside text-gray-700 text-sm">
                <li id="modal-fish-locais"></li>
                <li id="modal-fish-epoca"></li>
                <li id="modal-fish-mares"></li>
                <li id="modal-fish-iscas"></li>
            </ul>
        </div>
    </div>


    <!-- Menu de Navegação Inferior -->
    <nav class="bottom-nav">
        <a class="nav-button" href="#" data-target="home">
            <i class="icon fa-solid fa-house"></i>
            <span class="label">Início</span>
        </a>
        <a class="nav-button" href="#" data-target="tide-table">
            <i class="icon fa-solid fa-water"></i>
            <span class="label">Maré</span>
        </a>
        <a class="nav-button" href="#" data-target="events">
            <i class="icon fa-solid fa-calendar-alt"></i>
            <span class="label">Eventos</span>
        </a>
        <a class="nav-button active" href="#" data-target="fishing-news">
            <i class="icon fa-solid fa-newspaper"></i>
            <span class="label">Notícias</span>
        </a>
        <a class="nav-button" href="#" data-target="fishing-info">
            <i class="icon fa-solid fa-fish"></i>
            <span class="label">Pesca</span>
        </a>
        <a class="nav-button" href="#" data-target="ia-features">
            <i class="icon fa-solid fa-camera-retro"></i>
            <span class="label">IA</span>
        </a>
    </nav>
</div>

<script src="https://static.elfsight.com/platform/platform.js" async></script>
<script>
    // Referências aos elementos HTML
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('overlay');
    const openSidebarBtn = document.getElementById('open-sidebar-btn');
    const closeSidebarBtn = document.getElementById('close-sidebar-btn');
    const sidebarNavItems = document.querySelectorAll('.nav-item');
    const bottomNavButtons = document.querySelectorAll('.bottom-nav .nav-button');
    const screens = document.querySelectorAll('.screen');
    const instagramFeed = document.getElementById('instagram-feed');
    const tideContent = document.getElementById('tide-content');
    const newsList = document.getElementById('news-list');
    const eventsList = document.getElementById('events-list');
    const subCategoriesList = document.getElementById('sub-categories-list');
    const fishList = document.getElementById('fish-list');
    const backToFishingInfoBtns = document.querySelectorAll('.back-to-fishing-info-btn');

    // Gemini IA buttons and elements
    const iaFeaturesScreen = document.getElementById('ia-features');
    const backToHomeBtn = document.getElementById('back-to-home-btn');
    const fishImageInput = document.getElementById('fish-image-input');
    const fishPreview = document.getElementById('fish-preview');
    const identifyFishBtn = document.getElementById('identify-fish-btn');
    const fishResult = document.getElementById('fish-result');


    // Modal elements
    const eventModal = document.getElementById('event-modal');
    const closeModalBtn = document.getElementById('close-modal-btn');
    const modalEventImg = document.getElementById('modal-event-img');
    const modalEventTitle = document.getElementById('modal-event-title');
    const modalEventDate = document.getElementById('modal-event-date');
    const modalEventTime = document.getElementById('modal-event-time');
    const modalEventLocation = document.getElementById('modal-event-location');
    const modalEventDescription = document.getElementById('modal-event-description');

    const fishModal = document.getElementById('fish-modal');
    const closeFishModalBtn = document.getElementById('close-fish-modal-btn');
    const modalFishImg = document.getElementById('modal-fish-img');
    const modalFishName = document.getElementById('modal-fish-name');
    const modalFishBio = document.getElementById('modal-fish-bio');
    const modalFishLocais = document.getElementById('modal-fish-locais');
    const modalFishEpoca = document.getElementById('modal-fish-epoca');
    const modalFishMares = document.getElementById('modal-fish-mares');
    const modalFishIscas = document.getElementById('modal-fish-iscas');
    
    // Dados simulados da tábua de maré para os próximos dias
    const tideData = {
        city: "Maricá, RJ",
        days: [
            {
                date: "Hoje",
                tides: [
                    { type: "Alta", time: "04:10", height: 1.2 },
                    { type: "Baixa", time: "09:30", height: 0.4 },
                    { type: "Alta", time: "16:20", height: 1.5 },
                    { type: "Baixa", time: "22:05", height: 0.3 }
                ],
                chartData: [0.8, 1.2, 1.0, 0.6, 0.4, 0.7, 1.1, 1.5, 1.2, 0.8, 0.3, 0.5, 0.9]
            },
            {
                date: "Amanhã",
                tides: [
                    { type: "Alta", time: "05:00", height: 1.3 },
                    { type: "Baixa", time: "10:15", height: 0.5 },
                    { type: "Alta", time: "17:00", height: 1.6 },
                    { type: "Baixa", time: "23:00", height: 0.4 }
                ],
                chartData: [0.9, 1.3, 1.1, 0.7, 0.5, 0.8, 1.2, 1.6, 1.3, 0.9, 0.4, 0.6, 1.0]
            },
            {
                date: "Terça",
                tides: [
                    { type: "Alta", time: "05:45", height: 1.4 },
                    { type: "Baixa", time: "11:00", height: 0.6 },
                    { type: "Alta", time: "17:45", height: 1.7 },
                    { type: "Baixa", time: "23:50", height: 0.5 }
                ],
                chartData: [1.0, 1.4, 1.2, 0.8, 0.6, 0.9, 1.3, 1.7, 1.4, 1.0, 0.5, 0.7, 1.1]
            },
            {
                date: "Quarta",
                tides: [
                    { type: "Alta", time: "06:30", height: 1.5 },
                    { type: "Baixa", time: "11:45", height: 0.7 },
                    { type: "Alta", time: "18:30", height: 1.8 }
                ],
                chartData: [1.1, 1.5, 1.3, 0.9, 0.7, 1.0, 1.4, 1.8, 1.5, 1.1, 0.6, 0.8, 1.2]
            }
        ]
    };

    const fishingNews = [
        {
            title: "Prefeitura de Maricá abre inscrições para 4ª etapa do Circuito de Pesca Esportiva com Tarrafa",
            snippet: "Evento acontece no dia 24/08, das 7h às 17h, em Ponte Preta",
            imageUrl: "https://www.marica.rj.gov.br/wp-content/uploads/2025/07/WhatsApp-Image-2025-07-31-at-09.59.50.jpeg",
            url: "https://www.marica.rj.gov.br/noticia/prefeitura-de-marica-abre-inscricoes-para-4a-etapa-do-circuito-de-pesca-esportiva-com-tarrafa/"
        },
        {
            title: "Tilápia na mesa e dignidade no prato!",
            snippet: "Hoje nossa manhã começou com a entrega de peixes no Minha Casa Minha Vida de Itaipuaçu.",
            imageUrl: "https://i.pinimg.com/736x/81/d5/cf/81d5cfad34a864a6e0ea82ecf6f6eae2.jpg",
            url: "https://www.instagram.com/p/DLDARqzOfAq/?img_index=1"
        },
        {
            title: "Bioluminescência e o desassoreamento das lagoas de Maricá",
            snippet: "Nesta sexta-feira (27/06), o telejornal RJTV 1ª Edição, da TV Globo, exibiu uma matéria especial sobre um fenômeno raro e encantador que tem chamado a atenção de moradores e visitantes: a bioluminescência nas lagoas de Maricá.",
            imageUrl: "https://i.pinimg.com/736x/d4/6e/96/d46e9620e953f8ef03238f78d10eeede.jpg",
            url: "https://www.instagram.com/p/DLapbkLSz0c/"
        }
    ];

    const eventsData = [
        {
            title: "4° Etapa do Circuito de Pesca Artesanal com Tarrafa",
            date: "DOMINGO, 24 AGO 2025",
            time: "07:00",
            location: "Ponte Preta, Ao lado da ponte principal",
            imageUrl: "https://i.pinimg.com/736x/6a/4d/70/6a4d70087be2266f18c85eada1dda642.jpg",
            description: "Participe do nosso grande campeonato de tarrafa! Venha competir com pescadores artesanais de toda a região e mostrar suas habilidades. Prêmios, sorteios, shows ao vivo e muito mais!"
        }
    ];

    const fishData = [
        {
            name: "Tainha",
            imageUrl: "https://i.pinimg.com/736x/d2/be/cb/d2becbf83dbd6b4395aac98dfa5c14b2.jpg",
            bio: "Peixe marinho e estuarino da família Mugilidae, muito comum no sudeste e sul do Brasil. Vive em águas costeiras e salobras, alimentando-se de matéria orgânica e microalgas. Importante economicamente e muito valorizada na culinária (assada, recheada, com ova). Pode atingir até 70 cm e pesar 3 kg.",
            locais: "Praia da Barra de Maricá, Ponte Preta, Ponta do Boqueirão, Canal da Barra e entorno da Lagoa de Maricá, Restingas (em redes, espinhéis ou tarrafas).",
            epoca: "Maio a agosto, com pico em junho e julho (época da desova e migração).",
            mares: "Maré enchendo (subindo) e pico da maré cheia, Por quê? A tainha se aproxima da costa e estuários com a maré enchendo, pois entra para se alimentar. E o melhor horário é Início da manhã ou fim da tarde, com água movimentada.",
            iscas: "Camarão fresco, Lula, Miúdos de peixe (carne da própria tainha), Tatuí, Iscas vegetais também funcionam em anzol (massa de pão e farinha com sal)."
        },
        {
            name: "Pampo",
            imageUrl: "https://i.pinimg.com/736x/88/bb/cb/88bbcb2bdd83b7ef6865626a7be7eb3f.jpg",
            bio: "Peixe da família Carangidae, de corpo alto e prateado com tons amarelados. Vive em praias de arrebentação, águas rasas e fundos arenosos. Muito apreciado na pesca esportiva por sua força e também na culinária. Pode chegar a 50 cm e 5–6 kg.",
            locais: "Praia da Barra de Maricá, Praia de Cordeirinho, Praia de Ponta Negra, Arrebentações e “canais” formados na maré.",
            epoca: "Mais ativo na primavera e verão (outubro a março), quando as águas estão mais quentes.",
            mares: "Maré enchendo e cheia, Por quê? O pampo se alimenta em regiões de arrebentação e canais de areia, onde a água cobre o solo e movimenta a comida. E o melhor horário é duas horas antes até uma hora depois do pico da maré cheia.",
            iscas: "Camarão (vivo ou morto), Corrupto, Tatuí, Minhoca de praia. Também aceita isca artificial pequena em águas claras."
        },
        {
            name: "Robalo",
            imageUrl: "https://paginasdabio.ufpr.br/wp-content/uploads/2023/08/image-30.jpg",
            bio: "Espécie predadora e costeira, comum em estuários, manguezais e desembocaduras de rios. Robalo-peva (C. parallelus) é menor, e o robalo-flecha (C. undecimalis) é maior (até 1 m e 10 kg). Muito valorizado pela pesca esportiva por ser brigador e pela carne nobre.",
            locais: "Desembocadura do Canal da Barra, Manguezais e margens da Lagoa de Maricá, Canais salobros e fundos com estrutura (troncos, pedras, buracos)",
            epoca: "Mais ativo de setembro a abril. Entre maio e julho, em alguns estados ocorre defeso — é bom confirmar se há proibição local.",
            mares: "Marés de lua (cheia e nova) são as melhores.",
            iscas: "Começo da enchente ou começo da vazante, Por quê? Robalos gostam de caçar na corrente, perto de estruturas (troncos, pedras, mangue). Maré em movimento ativa o apetite deles. E o melhor horário é fim da tarde, madrugada ou amanhecer — principalmente quando a água está começando a correr."
        },
        {
            name: "Tilápia",
            imageUrl: "https://i.pinimg.com/736x/41/2a/23/412a2359dbb7f27ddb3d7fa62db189d1.jpg",
            bio: "A tilápia-do-nilo (Oreochromis niloticus) é a espécie mais comum no Brasil, originária da África e amplamente introduzida em represas, rios e criadouros. É um peixe de água doce e quente, de crescimento rápido, fácil adaptação, e muito utilizado na piscicultura comercial. Pode atingir até 50 cm e pesar mais de 4 kg, mas a maioria das capturas fica entre 300g e 1,5 kg. Alimenta-se de algas, detritos, insetos, ração e vegetação aquática. Tem carne branca, leve e saborosa.",
            locais: "Lagoas de água doce com pouco fluxo (se tiver alguma parte doce na Lagoa de Maricá), Represas, açudes e criadouros artificiais, Tanques de pesque-pague e fazendas de criação nos arredores da cidade (como Itaboraí, São Gonçalo, Rio Bonito). Dica: Em Maricá, pesque-pagues particulares costumam ter tilápia disponível para pesca recreativa.",
            epoca: "Primavera e verão (setembro a março). Evite os meses mais frios, pois ela se torna lenta e se alimenta menos.",
            mares: "Não se aplica diretamente, Por quê? Tilápias vivem em água doce parada ou com pouca correnteza, então maré não influencia diretamente. E o melhor horário é início da manhã ou fim da tarde.",
            iscas: "Massinha de pão com queijo ou leite, Ração de peixe molhada em forma de bolinha, Milho verde cozido, Minhoca, Insetos (larvas, grilo), Pedaços de banana ou frutas doces, Equipamento leve, anzóis pequenos (1 a 6), linha fina (0,20 a 0,28 mm) e uso de boia ou fundo."
        },
        {
            name: "Corvina",
            imageUrl: "https://i.pinimg.com/736x/75/2f/26/752f26c74c859e4a5be0ac096b63361b.jpg",
            bio: "Peixe costeiro da família Sciaenidae, muito comum no sudeste brasileiro. Vive em estuários, baías e fundos arenosos, geralmente em locais com correnteza leve. Muito valorizado pela pesca e culinária, carne branca e saborosa. Pode medir até 80 cm e pesar mais de 4 kg.",
            locais: "Canal da Barra, Lagoa de Maricá (áreas mais fundas e salobras), Desembocaduras de rios, Próximo a fundos de lama/areia com estrutura.",
            epoca: "Primavera e verão, mas pode ser capturada o ano todo. Costuma ser mais ativa no início da noite e madrugada, com maré enchendo.",
            mares: "Maré enchendo ou início da vazante, Por quê? Com a água movimentada, ela sai do fundo para caçar. Se alimenta bem com a maré subindo ou descendo, mas não com água parada. E o melhor horário é final da tarde e à noite (especialmente com maré mexendo).",
            iscas: "Camarão, Sardinha em pedaços, Tainhota (filé de peixes pequenos), Iscas artificiais (jig, shad em fundo)"
        }
    ];

    const subCategoriesData = [
        { title: "Peixes Comuns", icon: "fa-fish", target: "common-fish" },
        { title: "Período de Defeso", icon: "fa-ban", target: "fishing-closed-season" },
        { title: "Tamanhos Mínimos para Captura", icon: "fa-ruler-horizontal", target: "min-sizes" },
        { title: "Melhores Horários de Pesca", icon: "fa-clock", target: "best-fishing-times" },
        { title: "Licenciamento e Documentos", icon: "fa-file-alt", target: "licensing" }
    ];
    
    // Dados para as outras sub-categorias (simulados)
    const closedSeasonData = {
        title: "Período de Defeso",
        content: `O período de Defeso é a época em que a pesca de uma ou mais espécies é proibida para garantir sua reprodução e a manutenção dos estoques pesqueiros.
        
        **Defeso em Maricá:** O período de defeso na região de Maricá, para algumas espécies como a Tainha, geralmente ocorre de **Maio a Julho**. É importante sempre consultar a legislação mais recente para evitar multas.`,
        icon: "fa-ban",
        target: "fishing-closed-season"
    };

    const minSizesData = {
        title: "Tamanhos Mínimos para Captura",
        content: `A captura de peixes com tamanho inferior ao mínimo permitido por lei é considerada pesca predatória. Abaixo estão as medidas de algumas espécies comuns na região.`,
        icon: "fa-ruler-horizontal",
        target: "min-sizes"
    };

    const bestTimesData = {
        title: "Melhores Horários de Pesca",
        content: `A pesca é influenciada por fatores como a maré, a lua e o horário do dia.
        
        **Orientações Gerais:**
        - **Maré:** A mudança de maré (virada da maré) é um dos melhores momentos para pescar. A maré enchente também é favorável.
        - **Lua:** Luas cheia e nova (marés vivas) geralmente são mais produtivas.
        - **Horário:** O nascer e o pôr do sol são períodos de maior atividade para a maioria dos peixes.`,
        icon: "fa-clock",
        target: "best-fishing-times"
    };

    const licensingData = {
        title: "Licenciamento e Documentos",
        content: `A licença de pesca amadora é obrigatória para a pesca de linha e anzol, tanto em água doce quanto salgada.
        
        **Como tirar:**
        1. Acesse o portal do Ministério da Pesca e Aquicultura.
        2. Preencha o formulário com seus dados pessoais.
        3. Pague a taxa de emissão da licença.
        
        [Link para o site oficial (simulado)](#)`,
        icon: "fa-file-alt",
        target: "licensing"
    };
    
    const allSubCategoriesData = [
        ...subCategoriesData,
        closedSeasonData,
        minSizesData,
        bestTimesData,
        licensingData
    ];

    let currentDayIndex = 0; // Começa com "Hoje"
    
    // Inclusão do script do Elfsight para o feed do Instagram
    const elfsightScript = document.createElement('script');
    elfsightScript.src = 'https://static.elfsight.com/platform/platform.js';
    elfsightScript.async = true;
    document.head.appendChild(elfsightScript);

    // Função para renderizar o feed do Instagram
    function renderInstagramFeed() {
        // O widget do Elfsight fará o carregamento dos dados de forma assíncrona.
    }
    
    // Função para renderizar o gráfico de marés
    function renderTideChart(data) {
        const ctx = document.getElementById('tideChart').getContext('2d');
        const labels = ['0h', '2h', '4h', '6h', '8h', '10h', '12h', '14h', '16h', '18h', '20h', '22h', '24h'];
        
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Altura da Maré (m)',
                    data: data,
                    borderColor: 'rgb(59, 130, 246)',
                    backgroundColor: 'rgba(59, 130, 246, 0.2)',
                    fill: true,
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Altura (m)'
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        }
                    }
                }
            }
        });
    }

    // Função para buscar e exibir a tábua de maré (simulada)
    async function fetchTideData(dayIndex) {
        tideContent.innerHTML = `
            <div class="loading-indicator">
                <i class="fa-solid fa-water fa-spin-pulse fa-2x"></i>
                <p>Carregando tábua de maré...</p>
            </div>
        `;
        
        await new Promise(resolve => setTimeout(resolve, 1500));

        const currentDayData = tideData.days[dayIndex];
        
        tideContent.innerHTML = `
            <div class="bg-white p-4 rounded-xl shadow-md">
                <div class="flex items-center justify-between">
                    <span class="text-lg font-bold">${currentDayData.date}</span>
                    <span class="text-sm text-gray-500">${tideData.city}</span>
                </div>
                <div class="relative h-64 mt-4">
                    <canvas id="tideChart"></canvas>
                </div>
                <div class="flex justify-around mt-6">
                    ${currentDayData.tides.map(tide => `
                        <div class="flex flex-col items-center text-center">
                            <span class="text-sm font-semibold text-gray-700">Maré ${tide.type}</span>
                            <span class="text-xl font-bold text-blue-800">${tide.time}</span>
                            <span class="text-sm text-gray-500">${tide.height}m</span>
                        </div>
                    `).join('')}
                </div>
            </div>
            <div class="flex justify-between mt-4">
                <button id="prev-day" class="p-2 rounded-full bg-gray-200 text-gray-700 disabled:opacity-50">
                    <i class="fa-solid fa-chevron-left"></i>
                </button>
                <button id="today-btn" class="p-2 px-4 rounded-full bg-blue-600 text-white disabled:opacity-50">
                    Hoje
                </button>
                <button id="next-day" class="p-2 rounded-full bg-gray-200 text-gray-700 disabled:opacity-50">
                    <i class="fa-solid fa-chevron-right"></i>
                </button>
            </div>
        `;
        
        const prevButton = document.getElementById('prev-day');
        const nextButton = document.getElementById('next-day');
        const todayButton = document.getElementById('today-btn');

        if (dayIndex === 0) prevButton.disabled = true;
        if (dayIndex === tideData.days.length - 1) nextButton.disabled = true;

        prevButton.addEventListener('click', () => {
            currentDayIndex--;
            fetchTideData(currentDayIndex);
        });

        nextButton.addEventListener('click', () => {
            currentDayIndex++;
            fetchTideData(currentDayIndex);
        });

        todayButton.addEventListener('click', () => {
            currentDayIndex = 0;
            fetchTideData(currentDayIndex);
        });

        renderTideChart(currentDayData.chartData);
    }
    
    // Função para renderizar as notícias de pesca
    async function renderFishingNews() {
        newsList.innerHTML = `
            <div class="loading-indicator">
                <i class="fa-solid fa-newspaper fa-spin-pulse fa-2x"></i>
                <p>Carregando notícias...</p>
            </div>
        `;
        
        await new Promise(resolve => setTimeout(resolve, 1500));

        newsList.innerHTML = '';
        fishingNews.forEach(item => {
            const newsCard = `
                <a href="${item.url}" target="_blank" class="news-card">
                    <img src="${item.imageUrl}" alt="Imagem da notícia" class="w-20 h-20 object-cover rounded-lg flex-shrink-0">
                    <div class="flex flex-col">
                        <h4 class="font-semibold text-lg text-gray-800">${item.title}</h4>
                        <p class="text-sm text-gray-600 mt-1">${item.snippet}</p>
                    </div>
                </a>
            `;
            newsList.innerHTML += newsCard;
        });
    }

    // Função para renderizar a lista de eventos
    async function renderEvents() {
        eventsList.innerHTML = `
            <div class="loading-indicator">
                <i class="fa-solid fa-calendar-alt fa-spin-pulse fa-2x"></i>
                <p>Carregando eventos...</p>
            </div>
        `;
        
        await new Promise(resolve => setTimeout(resolve, 1500));

        eventsList.innerHTML = '';
        eventsData.forEach((event, index) => {
            const eventCard = `
                <div class="bg-white p-4 rounded-xl shadow-md flex flex-col gap-4 cursor-pointer event-card" data-index="${index}">
                    <div class="aspect-ratio-4-5 rounded-lg overflow-hidden">
                        <img src="${event.imageUrl}" alt="Imagem do Evento" class="w-full h-full object-cover">
                    </div>
                    <div class="flex flex-col">
                        <h3 class="font-semibold text-lg">${event.title}</h3>
                        <p class="text-sm text-gray-500 mt-1">${event.date} - ${event.time}</p>
                        <p class="text-sm text-gray-500">${event.location}</p>
                    </div>
                </div>
            `;
            eventsList.innerHTML += eventCard;
        });
        
        document.querySelectorAll('.event-card').forEach(card => {
            card.addEventListener('click', (e) => {
                const index = e.currentTarget.dataset.index;
                showEventModal(eventsData[index]);
            });
        });
    }
    
    function showEventModal(event) {
        modalEventImg.src = event.imageUrl;
        modalEventTitle.textContent = event.title;
        modalEventDate.textContent = event.date;
        modalEventTime.textContent = event.time;
        modalEventLocation.textContent = event.location;
        modalEventDescription.textContent = event.description;
        eventModal.classList.add('active');
        document.body.style.overflow = 'hidden';
    }

    function hideEventModal() {
        eventModal.classList.remove('active');
        document.body.style.overflow = 'auto';
    }

    closeModalBtn.addEventListener('click', hideEventModal);
    eventModal.addEventListener('click', (e) => {
        if (e.target === eventModal) {
            hideEventModal();
        }
    });
    
    // Função para renderizar as sub-categorias de pesca
    function renderSubCategories() {
        subCategoriesList.innerHTML = '';
        subCategoriesData.forEach(cat => {
            const card = `
                <div class="sub-category-card" data-target="${cat.target}">
                    <div class="sub-category-icon-bg">
                        <i class="fa-solid ${cat.icon} text-blue-600 text-xl"></i>
                    </div>
                    <h3 class="font-semibold text-lg">${cat.title}</h3>
                </div>
            `;
            subCategoriesList.innerHTML += card;
        });

        document.querySelectorAll('.sub-category-card').forEach(card => {
            card.addEventListener('click', (e) => {
                e.preventDefault();
                const targetId = e.currentTarget.dataset.target;
                changeScreen(targetId);
            });
        });
    }
    
    // Função para renderizar as telas de conteúdo das sub-categorias
    function renderContentScreen(contentData) {
        const screenId = contentData.target;
        const screenElement = document.getElementById(screenId);
        
        if (screenElement) {
            let contentHTML = `
                <div class="flex items-center justify-start gap-4 mb-4">
                    <button class="back-to-fishing-info-btn text-gray-700 text-xl p-2 rounded-full hover:bg-gray-200 transition-colors">
                        <i class="fa-solid fa-arrow-left"></i>
                    </button>
                    <h2 class="text-2xl font-bold uppercase text-gray-800">${contentData.title}</h2>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md">
                    <p class="text-gray-700 mb-4">${contentData.content.replace(/\n/g, '<br>')}</p>
                </div>
            `;

            // Adiciona uma lista se o conteúdo for de tamanhos mínimos
            if (contentData.icon === "fa-ruler-horizontal") {
                contentHTML = `
                    <div class="flex items-center justify-start gap-4 mb-4">
                        <button class="back-to-fishing-info-btn text-gray-700 text-xl p-2 rounded-full hover:bg-gray-200 transition-colors">
                            <i class="fa-solid fa-arrow-left"></i>
                        </button>
                        <h2 class="text-2xl font-bold uppercase text-gray-800">${contentData.title}</h2>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-md">
                        <p class="text-gray-700 mb-4">${contentData.content.split('**Medidas Mínimas:**')[0]}</p>
                        <h3 class="font-bold text-lg mb-2">Medidas Mínimas:</h3>
                        <ul class="flex flex-col gap-2">
                            <li class="flex justify-between font-semibold text-gray-700 bg-gray-50 p-3 rounded-lg">
                                <span>Tainha</span>
                                <span>30 cm</span>
                            </li>
                            <li class="flex justify-between font-semibold text-gray-700 bg-gray-50 p-3 rounded-lg">
                                <span>Pampo</span>
                                <span>25 cm</span>
                            </li>
                            <li class="flex justify-between font-semibold text-gray-700 bg-gray-50 p-3 rounded-lg">
                                <span>Robalo</span>
                                <span>35 cm</span>
                            </li>
                            <li class="flex justify-between font-semibold text-gray-700 bg-gray-50 p-3 rounded-lg">
                                <span>Corvina</span>
                                <span>20 cm</span>
                            </li>
                        </ul>
                    </div>
                `;
            }
            
            screenElement.innerHTML = contentHTML;
            screenElement.querySelector('.back-to-fishing-info-btn').addEventListener('click', () => {
                changeScreen('fishing-info');
            });
        }
    }

    // Função para renderizar a lista de peixes
    function renderFishList() {
        fishList.innerHTML = '';
        fishData.forEach((fish, index) => {
            const card = `
                <div class="bg-white p-4 rounded-xl shadow-md flex items-center gap-4 cursor-pointer fish-card" data-index="${index}">
                    <img src="${fish.imageUrl}" alt="Imagem do Peixe" class="w-16 h-16 object-cover rounded-full">
                    <div class="flex-1">
                        <h3 class="font-semibold text-lg">${fish.name}</h3>
                        <p class="text-sm text-gray-500">${fish.bio.substring(0, 50)}...</p>
                    </div>
                    <i class="fa-solid fa-chevron-right text-gray-400"></i>
                </div>
            `;
            fishList.innerHTML += card;
        });

        document.querySelectorAll('.fish-card').forEach(card => {
            card.addEventListener('click', (e) => {
                const index = e.currentTarget.dataset.index;
                showFishModal(fishData[index]);
            });
        });
    }

    function showFishModal(fish) {
        modalFishImg.src = fish.imageUrl;
        modalFishName.textContent = fish.name;
        modalFishBio.textContent = fish.bio;
        modalFishLocais.textContent = `Melhores locais: ${fish.locais}`;
        modalFishEpoca.textContent = `Melhor época: ${fish.epoca}`;
        modalFishMares.textContent = `Melhores marés: ${fish.mares}`;
        modalFishIscas.textContent = `Melhores iscas: ${fish.iscas}`;
        fishModal.classList.add('active');
        document.body.style.overflow = 'hidden';
    }

    function hideFishModal() {
        fishModal.classList.remove('active');
        document.body.style.overflow = 'auto';
    }

    closeFishModalBtn.addEventListener('click', hideFishModal);
    fishModal.addEventListener('click', (e) => {
        if (e.target === fishModal) {
            hideFishModal();
        }
    });
    
    backToFishingInfoBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            changeScreen('fishing-info');
        });
    });

    // Gemini API functions
    async function callGeminiApiWithImage(imageData) {
        // Simulação da chamada da API Gemini com imagem
        await new Promise(resolve => setTimeout(resolve, 2000));
        return "Simulação de resposta da Gemini: \"Este peixe parece ser um Pampo. É um peixe esportivo muito apreciado e comum em praias de Maricá.\"";
    }

    // Event listeners para as novas funcionalidades IA
    
    fishImageInput.addEventListener('change', (event) => {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                fishPreview.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }
    });

    identifyFishBtn.addEventListener('click', async () => {
        const imageData = fishPreview.src;
        if (imageData.startsWith('data:')) {
            fishResult.textContent = 'Identificando peixe...';
            const response = await callGeminiApiWithImage(imageData);
            fishResult.textContent = response;
        } else {
            fishResult.textContent = 'Por favor, selecione uma imagem primeiro.';
        }
    });
    
    // Função para abrir o menu lateral
    function openSidebar() {
        sidebar.classList.add('active');
        overlay.classList.add('active');
    }

    // Função para fechar o menu lateral
    function closeSidebar() {
        sidebar.classList.remove('active');
        overlay.classList.remove('active');
    }

    // Função para mudar a tela exibida e atualizar o estado ativo dos botões
    function changeScreen(targetId) {
        const targetScreen = document.getElementById(targetId);
        if (!targetScreen) {
            console.error(`Elemento com ID '${targetId}' não encontrado.`);
            return;
        }

        screens.forEach(screen => {
            screen.classList.remove('active');
        });
        targetScreen.classList.add('active');

        if (targetId === 'home') {
            renderInstagramFeed();
        } else if (targetId === 'tide-table') {
            currentDayIndex = 0;
            fetchTideData(currentDayIndex);
        } else if (targetId === 'fishing-news') {
            renderFishingNews();
        } else if (targetId === 'events') {
            renderEvents();
        } else if (targetId === 'fishing-info') {
            renderSubCategories();
        } else if (targetId === 'common-fish') {
            renderFishList();
        } else if (targetId === 'ia-features') {
             // A tela de IA foi movida, não precisa de renderização especial
        } else {
            const subCatData = allSubCategoriesData.find(cat => cat.target === targetId);
            if (subCatData) {
                renderContentScreen(subCatData);
            }
        }
        
        sidebarNavItems.forEach(item => {
            const itemTarget = item.dataset.target;
            if (itemTarget === targetId) {
                item.classList.add('bg-red-100', 'text-red-600');
            } else {
                item.classList.remove('bg-red-100', 'text-red-600');
            }
        });
        bottomNavButtons.forEach(item => {
            const itemTarget = item.dataset.target;
            if (itemTarget === targetId) {
                item.classList.add('active');
            } else {
                item.classList.remove('active');
            }
        });
    }

    openSidebarBtn.addEventListener('click', openSidebar);
    closeSidebarBtn.addEventListener('click', closeSidebar);
    overlay.addEventListener('click', closeSidebar);

    sidebarNavItems.forEach(item => {
        item.addEventListener('click', (e) => {
            e.preventDefault();
            const targetId = item.dataset.target;
            changeScreen(targetId);
            closeSidebar();
        });
    });

    bottomNavButtons.forEach(button => {
        button.addEventListener('click', (e) => {
            e.preventDefault();
            const targetId = button.dataset.target;
            changeScreen(targetId);
        });
    });

    window.onload = function() {
      changeScreen('home');
    };
</script>

</body>
</html>
